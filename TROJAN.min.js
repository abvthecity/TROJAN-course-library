"use strict";!function(){var e={};const t=require("http"),r=require("async");var o=function(e,r){function o(){t.get(e,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){try{var e=JSON.parse(t);r(e)}catch(o){}})}).on("error",function(e){console.error("Error: ",e)})}e="http://web-app.usc.edu/web/soc/api"+e,setTimeout(o,150)};e.term=function(e,t){t=t||{};var r="/terms";o(r,function(r){e(t.curr?r.term[r.term.length-1]:r.term)})},e.current_term=function(t,r){e.term(t,{curr:!0})},e.dept_raw=function(t,c){function n(e){var c="/depts/"+e;o(c,function(e){r.each(e.department,function(e){t(e)})})}c=c||{},c.term?n(c.term):e.current_term(n)},e.school=function(t,r){function o(e){r.school?e.code.toLowerCase()==r.school.toLowerCase()&&t(e):t(r.justcode?e.code:e)}r=r||{},r.justcode=1==r.justcode,r.data_dump?o(r.data_dump):e.dept_raw(o,{term:r.term})},e.dept=function(t,o){function c(e){if(void 0!=e.department){var c=e.department;Array.isArray(c)||(c=[c]),r.each(c,function(e){n.indexOf(e.code)>-1||(n.push(e.code),t(o.justcode?e.code:e))})}}o=o||{},o.justcode=1==o.justcode;var n=[];e.school(function(t){o.school?e.school(function(e){c(e)},{school:o.school,data_dump:t}):c(t)},{term:o.term})},e.dept_info=function(t,r){function c(e,t,r){var c="/classes/"+e+"/"+t;o(c,function(e){r(e.Dept_Info)})}function n(r){e.dept(function(e){c(e,r,t)},{term:r,justcode:!0})}r=r||{},r.dept?r.term?c(r.dept,r.term,t):e.current_term(function(e){c(r.dept,e,t)}):r.term?n(r.term):e.current_term(function(e){n(e)})},e.course_raw=function(t,c){function n(e,t,n){var u="/classes/"+e+"/"+t;o(u,function(e){function t(e){s.indexOf(o.ScheduledCourseID)>-1||(s.push(e.ScheduledCourseID),n(c.justcode?e.ScheduledCourseID:e))}var o=e.OfferedCourses.course;Array.isArray(o)?r.each(o,function(e){t(e)}):void 0!=o&&t(o)})}function u(r){e.dept(function(e){n(e,r,t)},{justcode:!0})}c=c||{},c.justcode=1==c.justcode;var s=[];c.dept?c.term?n(c.dept,c.term,t):e.current_term(function(e){n(c.dept,e,t)}):c.justcode?c.term?u(c.term):e.current_term(u):console.error("Please at LEAST include {justcode:true}")},e.course=function(t,r){function o(t,r,o,c,n){e.course_raw(function(e){(e.ScheduledCourseID==t+"-"+r+o||e.CourseData.prefix==t&&e.CourseData.number==r)&&n(e.CourseData)},{dept:t,term:c})}if(r=r||{},r.course){r.course=r.course.toUpperCase();var c=r.course.split("-");c[1].length>3&&(c[2]=c[1].substring(3),c[1]=c[1].substring(0,3)),2!=c.length&&3!=c.length||!isNaN(c[0])||isNaN(c[1])?console.error("courseid format incorrect"):r.term?o(c[0],c[1],c[2],r.term,t):e.current_term(function(e){o(c[0],c[1],c[2],e,t)})}else console.error("Need a course")},e.sect=function(t,o){o=o||{},o.justcode=1==o.justcode,e.course(function(e){var c=e.SectionData;Array.isArray(c)||(c=[c]),o.sect?r.each(c,function(e){e.id==o.sect.substring(0,5)&&t(o.justcode?e.id+e.dclass_code:e)}):r.each(c,function(e){t(o.justcode?e.id+e.dclass_code:e)})},{course:o.course,term:o.term})},"object"==typeof module&&module.exports&&(module.exports=e)}();